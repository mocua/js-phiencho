/*
 Infinite Scroll PACKAGED v3.0.2
 Automatically add next page

 Licensed GPLv3 for open source use
 or Infinite Scroll Commercial License for commercial use

 https://infinite-scroll.com
 Copyright 2017 Metafizzy
*/
!function(c,b){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(f){return b(c,f)}):"object"==typeof module&&module.exports?module.exports=b(c,require("jquery")):c.jQueryBridget=b(c,c.jQuery)}(window,function(c,b){function f(d,f,l){function g(g,a,m){var b,e="$()."+d+'("'+a+'")';return g.each(function(g,c){var f=l.data(c,d);if(!f)return void h(d+" not initialized. Cannot call methods, i.e. "+e);var k=f[a];if(!k||"_"==a.charAt(0))return void h(e+" is not a valid method");
f=k.apply(f,m);b=void 0===b?f:b}),void 0!==b?b:g}function m(g,a){g.each(function(g,b){var m=l.data(b,d);m?(m.option(a),m._init()):(m=new f(b,a),l.data(b,d,m))})}(l=l||b||c.jQuery)&&(f.prototype.option||(f.prototype.option=function(g){l.isPlainObject(g)&&(this.options=l.extend(!0,this.options,g))}),l.fn[d]=function(d){if("string"==typeof d){var b=a.call(arguments,1);return g(this,d,b)}return m(this,d),this},e(l))}function e(a){!a||a&&a.bridget||(a.bridget=f)}var a=Array.prototype.slice,d=c.console,
h="undefined"==typeof d?function(){}:function(a){d.error(a)};return e(b||c.jQuery),f});
(function(c,b){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",b):"object"==typeof module&&module.exports?module.exports=b():c.EvEmitter=b()})("undefined"!=typeof window?window:this,function(){function c(){}var b=c.prototype;return b.on=function(b,e){if(b&&e){var a=this._events=this._events||{};a=a[b]=a[b]||[];return-1==a.indexOf(e)&&a.push(e),this}},b.once=function(b,e){if(b&&e){this.on(b,e);var a=this._onceEvents=this._onceEvents||{};return(a[b]=a[b]||{})[e]=!0,this}},b.off=
function(b,e){var a=this._events&&this._events[b];if(a&&a.length){var d=a.indexOf(e);return-1!=d&&a.splice(d,1),this}},b.emitEvent=function(b,e){var a=this._events&&this._events[b];if(a&&a.length){var d=0,c=a[d];e=e||[];for(var k=this._onceEvents&&this._onceEvents[b];c;){var f=k&&k[c];f&&(this.off(b,c),delete k[c]);c.apply(this,e);d+=f?0:1;c=a[d]}return this}},b.allOff=b.removeAllListeners=function(){delete this._events;delete this._onceEvents},c});
(function(c,b){"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",b):"object"==typeof module&&module.exports?module.exports=b():c.matchesSelector=b()})(window,function(){var c=function(){var b=window.Element.prototype;if(b.matches)return"matches";if(b.matchesSelector)return"matchesSelector";for(var c=["webkit","moz","ms","o"],e=0;e<c.length;e++){var a=c[e]+"MatchesSelector";if(b[a])return a}}();return function(b,f){return b[c](f)}});
(function(c,b){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(f){return b(c,f)}):"object"==typeof module&&module.exports?module.exports=b(c,require("desandro-matches-selector")):c.fizzyUIUtils=b(c,c.matchesSelector)})(window,function(c,b){var f={extend:function(a,d){for(var b in d)a[b]=d[b];return a},modulo:function(a,d){return(a%d+d)%d},makeArray:function(a){var d=[];if(Array.isArray(a))d=a;else if(a&&"object"==typeof a&&
"number"==typeof a.length)for(var b=0;b<a.length;b++)d.push(a[b]);else d.push(a);return d},removeFrom:function(a,d){var b=a.indexOf(d);-1!=b&&a.splice(b,1)},getParent:function(a,d){for(;a.parentNode&&a!=document.body;)if(a=a.parentNode,b(a,d))return a},getQueryElement:function(a){return"string"==typeof a?document.querySelector(a):a},handleEvent:function(a){var d="on"+a.type;this[d]&&this[d](a)},filterFindElements:function(a,d){a=f.makeArray(a);var c=[];return a.forEach(function(a){if(a instanceof
HTMLElement){if(!d)return void c.push(a);b(a,d)&&c.push(a);a=a.querySelectorAll(d);for(var e=0;e<a.length;e++)c.push(a[e])}}),c},debounceMethod:function(a,d,b){var c=a.prototype[d],e=d+"Timeout";a.prototype[d]=function(){var a=this[e];a&&clearTimeout(a);var g=arguments,d=this;this[e]=setTimeout(function(){c.apply(d,g);delete d[e]},b||100)}},docReady:function(a){var d=document.readyState;"complete"==d||"interactive"==d?setTimeout(a):document.addEventListener("DOMContentLoaded",a)},toDashed:function(a){return a.replace(/(.)([A-Z])/g,
function(a,b,c){return b+"-"+c}).toLowerCase()}},e=c.console;return f.htmlInit=function(a,d){f.docReady(function(){var b=f.toDashed(d),k="data-"+b,n=document.querySelectorAll("["+k+"]");b=document.querySelectorAll(".js-"+b);n=f.makeArray(n).concat(f.makeArray(b));var l=k+"-options",g=c.jQuery;n.forEach(function(b){var c=b.getAttribute(k)||b.getAttribute(l);try{var m=c&&JSON.parse(c)}catch(p){return void(e&&e.error("Error parsing "+k+" on "+b.className+": "+p))}m=new a(b,m);g&&g.data(b,d,m)})})},f});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/core",["ev-emitter/ev-emitter","fizzy-ui-utils/utils"],function(f,e){return b(c,f,e)}):"object"==typeof module&&module.exports?module.exports=b(c,require("ev-emitter"),require("fizzy-ui-utils")):c.InfiniteScroll=b(c,c.EvEmitter,c.fizzyUIUtils)})(window,function(c,b,f){function e(g,b){var c=f.getQueryElement(g);if(!c)return void console.error("Bad element for InfiniteScroll: "+(c||g));if(g=c,g.infiniteScrollGUID)return c=
d[g.infiniteScrollGUID],c.option(b),c;this.element=g;this.options=f.extend({},e.defaults);this.option(b);a&&(this.$element=a(this.element));this.create()}var a=c.jQuery,d={};e.defaults={};e.create={};e.destroy={};var h=e.prototype;f.extend(h,b.prototype);var k=0;h.create=function(){var a=this.guid=++k;if(this.element.infiniteScrollGUID=a,d[a]=this,this.pageIndex=1,this.loadCount=0,this.updateGetPath(),!this.getPath)return void console.error("Disabling InfiniteScroll");this.updateGetAbsolutePath();
this.log("initialized",[this.element.className]);this.callOnInit();for(var b in e.create)e.create[b].call(this)};h.option=function(a){f.extend(this.options,a)};h.callOnInit=function(){var a=this.options.onInit;a&&a.call(this,this)};h.dispatchEvent=function(b,d,c){this.log(b,c);var g=d?[d].concat(c):c;if(this.emitEvent(b,g),a&&this.$element)g=b+=".infiniteScroll",d&&(d=a.Event(d),d.type=b,g=d),this.$element.trigger(g,c)};var n={initialized:function(a){return"on "+a},request:function(a){return"URL: "+
a},load:function(a,b){return(a.title||"")+". URL: "+b},error:function(a,b){return a+". URL: "+b},append:function(a,b,d){return d.length+" items. URL: "+b},last:function(a,b){return"URL: "+b},history:function(a,b){return"URL: "+b},pageIndex:function(a,b){return"current page determined to be: "+a+" from "+b}};h.log=function(a,b){if(this.options.debug){var d="[InfiniteScroll] "+a,c=n[a];c&&(d+=". "+c.apply(this,b));console.log(d)}};h.updateMeasurements=function(){this.windowHeight=c.innerHeight;this.top=
this.element.getBoundingClientRect().top+c.pageYOffset};h.updateScroller=function(){var a=this.options.elementScroll;if(!a)return void(this.scroller=c);if(this.scroller=!0===a?this.element:f.getQueryElement(a),!this.scroller)throw"Unable to find elementScroll: "+a;};h.updateGetPath=function(){var a=this.options.path;if(!a)return void console.error("InfiniteScroll path option required. Set as: "+a);var b=typeof a;return"function"==b?void(this.getPath=a):"string"==b&&a.match("{{#}}")?void this.updateGetPathTemplate(a):
void this.updateGetPathSelector(a)};h.updateGetPathTemplate=function(a){this.getPath=function(){return a.replace("{{#}}",this.pageIndex+1)}.bind(this);var b=a.replace("{{#}}","(\\d\\d?\\d?)");(b=location.href.match(new RegExp(b)))&&(this.pageIndex=parseInt(b[1],10),this.log("pageIndex",this.pageIndex,"template string"))};var l=[/^(.*?\/?page\/?)(\d\d?\d?)(.*?$)/,/^(.*?\/?\?page=)(\d\d?\d?)(.*?$)/,/(.*?)(\d\d?\d?)(?!.*\d)(.*?$)/];return h.updateGetPathSelector=function(a){var b=document.querySelector(a);
if(!b)return void console.error("Bad InfiniteScroll path option. Next link not found: "+a);a=b.getAttribute("href");for(b=0;a&&b<l.length;b++){var d=l[b];if(d=a.match(d)){var c=d.slice(1);break}}return c?(this.isPathSelector=!0,this.getPath=function(){return c[0]+(this.pageIndex+1)+c[2]}.bind(this),this.pageIndex=parseInt(c[1],10)-1,void this.log("pageIndex",[this.pageIndex,"next link"])):void console.error("InfiniteScroll unable to parse next link href: "+a)},h.updateGetAbsolutePath=function(){var a=
this.getPath();if(a.match(/^http/)||a.match(/^\//))return void(this.getAbsolutePath=this.getPath);a=location.pathname;var b=a.substring(0,a.lastIndexOf("/"));this.getAbsolutePath=function(){return b+"/"+this.getPath()}},e.create.hideNav=function(){var a=f.getQueryElement(this.options.hideNav);a&&(a.style.display="none",this.nav=a)},e.destroy.hideNav=function(){this.nav&&(this.nav.style.display="")},h.destroy=function(){this.allOff();for(var a in e.destroy)e.destroy[a].call(this);delete this.element.infiniteScrollGUID;
delete d[this.guid]},e.throttle=function(a,b){b=b||200;var d,c;return function(){var e=+new Date,g=arguments,f=function(){d=e;a.apply(this,g)}.bind(this);d&&e<d+b?(clearTimeout(c),c=setTimeout(f,b)):f()}},e.data=function(a){return(a=(a=f.getQueryElement(a))&&a.infiniteScrollGUID)&&d[a]},e.setJQuery=function(b){a=b},f.htmlInit(e,"infinite-scroll"),a&&a.bridget&&a.bridget("infiniteScroll",e),e});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/page-load",["./core"],function(f){return b(c,f)}):"object"==typeof module&&module.exports?module.exports=b(c,require("./core")):b(c,c.InfiniteScroll)})(window,function(c,b){function f(a){for(var b=document.createDocumentFragment(),d=0;a&&d<a.length;d++)b.appendChild(a[d]);return b}function e(a,b,c,e){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType=b||"";d.setRequestHeader("X-Requested-With","XMLHttpRequest");
d.onload=function(){200==d.status?c(d.response):e(Error(d.statusText))};d.onerror=function(){e(Error("Network error requesting "+a))};d.send()}var a=b.prototype;return b.defaults.loadOnScroll=!0,b.defaults.checkLastPage=!0,b.defaults.responseType="document",b.create.pageLoad=function(){this.canLoad=!0;this.on("scrollThreshold",this.onScrollThresholdLoad);this.on("append",this.checkLastPage);this.options.outlayer&&this.on("append",this.onAppendOutlayer)},a.onScrollThresholdLoad=function(){this.options.loadOnScroll&&
this.loadNextPage()},a.loadNextPage=function(){if(!this.isLoading&&this.canLoad){var a=this.getAbsolutePath();this.isLoading=!0;var b=function(b){this.onPageLoad(b,a)}.bind(this),c=function(b){this.onPageError(b,a)}.bind(this);e(a,this.options.responseType,b,c);this.dispatchEvent("request",null,[a])}},a.onPageLoad=function(a,b){return this.options.append||(this.isLoading=!1),this.pageIndex++,this.loadCount++,this.dispatchEvent("load",null,[a,b]),this.appendNextPage(a,b),a},a.appendNextPage=function(a,
b){var d=this.options.append;if("document"==this.options.responseType&&d){var c=a.querySelectorAll(d),e=f(c);d=function(){this.appendItems(c,e);this.isLoading=!1;this.dispatchEvent("append",null,[a,b,c])}.bind(this);this.options.outlayer?this.appendOutlayerItems(e,d):d()}},a.appendItems=function(a,b){if(a&&a.length){b=b||f(a);for(var d=b.querySelectorAll("script"),c=0;c<d.length;c++){for(var e=d[c],g=document.createElement("script"),m=g,h=e.attributes,q=0;q<h.length;q++){var p=h[q];m.setAttribute(p.name,
p.value)}e.parentNode.replaceChild(g,e)}this.element.appendChild(b)}},a.appendOutlayerItems=function(a,e){var d=b.imagesLoaded||c.imagesLoaded;return d?void d(a,e):(console.error("[InfiniteScroll] imagesLoaded required for outlayer option"),void(this.isLoading=!1))},a.onAppendOutlayer=function(a,b,c){this.options.outlayer.appended(c)},a.checkLastPage=function(a,b){var c=this.options.checkLastPage;if(c){var d=this.options.path;if("function"==typeof d&&!this.getPath())return void this.lastPageReached(a,
b);var e;if("string"==typeof c?e=c:this.isPathSelector&&(e=d),e&&a.querySelector)a.querySelector(e)||this.lastPageReached(a,b)}},a.lastPageReached=function(a,b){this.canLoad=!1;this.dispatchEvent("last",null,[a,b])},a.onPageError=function(a,b){return this.isLoading=!1,this.canLoad=!1,this.dispatchEvent("error",null,[a,b]),a},b.create.prefill=function(){if(this.options.prefill){var a=this.options.append;if(!a)return void console.error("append option required for prefill. Set as :"+a);this.updateMeasurements();
this.updateScroller();this.isPrefilling=!0;this.on("append",this.prefill);this.once("error",this.stopPrefill);this.once("last",this.stopPrefill);this.prefill()}},a.prefill=function(){(this.isPrefilling=0<=this.getPrefillDistance())?(this.log("prefill"),this.loadNextPage()):this.stopPrefill()},a.getPrefillDistance=function(){return this.options.elementScroll?this.scroller.clientHeight-this.scroller.scrollHeight:this.windowHeight-this.element.clientHeight},a.stopPrefill=function(){console.log("stopping prefill");
this.off("append",this.prefill)},b});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/scroll-watch",["./core","fizzy-ui-utils/utils"],function(f,e){return b(c,f,e)}):"object"==typeof module&&module.exports?module.exports=b(c,require("./core"),require("fizzy-ui-utils")):b(c,c.InfiniteScroll,c.fizzyUIUtils)})(window,function(c,b,f){var e=b.prototype;return b.defaults.scrollThreshold=400,b.create.scrollWatch=function(){this.pageScrollHandler=this.onPageScroll.bind(this);this.resizeHandler=this.onResize.bind(this);
var a=this.options.scrollThreshold;(a||0===a)&&this.enableScrollWatch()},b.destroy.scrollWatch=function(){this.disableScrollWatch()},e.enableScrollWatch=function(){this.isScrollWatching||(this.isScrollWatching=!0,this.updateMeasurements(),this.updateScroller(),this.on("last",this.disableScrollWatch),this.bindScrollWatchEvents(!0))},e.disableScrollWatch=function(){this.isScrollWatching&&(this.bindScrollWatchEvents(!1),delete this.isScrollWatching)},e.bindScrollWatchEvents=function(a){a=a?"addEventListener":
"removeEventListener";this.scroller[a]("scroll",this.pageScrollHandler);c[a]("resize",this.resizeHandler)},e.onPageScroll=b.throttle(function(){this.getBottomDistance()<=this.options.scrollThreshold&&this.dispatchEvent("scrollThreshold")}),e.getBottomDistance=function(){return this.options.elementScroll?this.getElementBottomDistance():this.getWindowBottomDistance()},e.getWindowBottomDistance=function(){return this.top+this.element.clientHeight-(c.pageYOffset+this.windowHeight)},e.getElementBottomDistance=
function(){return this.scroller.scrollHeight-(this.scroller.scrollTop+this.scroller.clientHeight)},e.onResize=function(){this.updateMeasurements()},f.debounceMethod(b,"onResize",150),b});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/history",["./core","fizzy-ui-utils/utils"],function(f,e){return b(c,f,e)}):"object"==typeof module&&module.exports?module.exports=b(c,require("./core"),require("fizzy-ui-utils")):b(c,c.InfiniteScroll,c.fizzyUIUtils)})(window,function(c,b,f){var e=b.prototype;b.defaults.history="replace";var a=document.createElement("a");return b.create.history=function(){if(this.options.history)return a.href=this.getAbsolutePath(),(a.origin||
a.protocol+"//"+a.host)==location.origin?void(this.options.append?this.createHistoryAppend():this.createHistoryPageLoad()):void console.error("[InfiniteScroll] cannot set history with different origin: "+a.origin+" on "+location.origin+" . History behavior disabled.")},e.createHistoryAppend=function(){this.updateMeasurements();this.updateScroller();this.scrollPages=[{top:0,path:location.href,title:document.title}];this.scrollPageIndex=0;this.scrollHistoryHandler=this.onScrollHistory.bind(this);this.unloadHandler=
this.onUnload.bind(this);this.scroller.addEventListener("scroll",this.scrollHistoryHandler);this.on("append",this.onAppendHistory);this.bindHistoryAppendEvents(!0)},e.bindHistoryAppendEvents=function(a){a=a?"addEventListener":"removeEventListener";this.scroller[a]("scroll",this.scrollHistoryHandler);c[a]("unload",this.unloadHandler)},e.createHistoryPageLoad=function(){this.on("load",this.onPageLoadHistory)},b.destroy.history=e.destroyHistory=function(){this.options.history&&this.options.append&&this.bindHistoryAppendEvents(!1)},
e.onAppendHistory=function(b,c,e){e=this.getElementScrollY(e[0]);a.href=c;this.scrollPages.push({top:e,path:a.href,title:b.title})},e.getElementScrollY=function(a){return this.options.elementScroll?this.getElementElementScrollY(a):this.getElementWindowScrollY(a)},e.getElementWindowScrollY=function(a){return a.getBoundingClientRect().top+c.pageYOffset},e.getElementElementScrollY=function(a){return a.offsetTop-this.top},e.onScrollHistory=function(){for(var a,b,c=this.getScrollViewY(),e=0;e<this.scrollPages.length;e++){var f=
this.scrollPages[e];if(f.top>=c)break;a=e;b=f}a!=this.scrollPageIndex&&(this.scrollPageIndex=a,this.setHistory(b.title,b.path))},f.debounceMethod(b,"onScrollHistory",150),e.getScrollViewY=function(){return this.options.elementScroll?this.scroller.scrollTop+this.scroller.clientHeight/2:c.pageYOffset+this.windowHeight/2},e.setHistory=function(a,b){var c=this.options.history;c&&history[c+"State"]&&(history[c+"State"](null,a,b),this.options.historyTitle&&(document.title=a),this.dispatchEvent("history",
null,[a,b]))},e.onUnload=function(){var a=this.scrollPageIndex;0!==a&&(a=c.pageYOffset-this.scrollPages[a].top+this.top,this.destroyHistory(),scrollTo(0,a))},e.onPageLoadHistory=function(a,b){this.setHistory(a.title,b)},b});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/button",["./core","fizzy-ui-utils/utils"],function(f,e){return b(c,f,e)}):"object"==typeof module&&module.exports?module.exports=b(c,require("./core"),require("fizzy-ui-utils")):b(c,c.InfiniteScroll,c.fizzyUIUtils)})(window,function(c,b,f){function e(a,b){this.element=a;this.infScroll=b;this.clickHandler=this.onClick.bind(this);this.element.addEventListener("click",this.clickHandler);b.on("request",this.disable.bind(this));
b.on("load",this.enable.bind(this));b.on("error",this.hide.bind(this));b.on("last",this.hide.bind(this))}return b.create.button=function(){var a=f.getQueryElement(this.options.button);if(a)return void(this.button=new e(a,this))},b.destroy.button=function(){this.button&&this.button.destroy()},e.prototype.onClick=function(a){a.preventDefault();this.infScroll.loadNextPage()},e.prototype.enable=function(){this.element.removeAttribute("disabled")},e.prototype.disable=function(){this.element.disabled="disabled"},
e.prototype.hide=function(){this.element.style.display="none"},e.prototype.destroy=function(){this.element.removeEventListener("click",this.clickHandler)},b.Button=e,b});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/status",["./core","fizzy-ui-utils/utils"],function(f,e){return b(c,f,e)}):"object"==typeof module&&module.exports?module.exports=b(c,require("./core"),require("fizzy-ui-utils")):b(c,c.InfiniteScroll,c.fizzyUIUtils)})(window,function(c,b,f){c=b.prototype;return b.create.status=function(){var b=f.getQueryElement(this.options.status);b&&(this.statusElement=b,this.statusEventElements={request:b.querySelector(".infinite-scroll-request"),
error:b.querySelector(".infinite-scroll-error"),last:b.querySelector(".infinite-scroll-last")},this.on("request",this.showRequestStatus),this.on("error",this.showErrorStatus),this.on("last",this.showLastStatus),this.bindHideStatus("on"))},c.bindHideStatus=function(b){this[b](this.options.append?"append":"load",this.hideAllStatus)},c.showRequestStatus=function(){this.showStatus("request")},c.showErrorStatus=function(){this.showStatus("error")},c.showLastStatus=function(){this.showStatus("last");this.bindHideStatus("off")},
c.showStatus=function(b){var a=this.statusElement;a&&(a.style.display="block");this.hideStatusEventElements();(b=this.statusEventElements[b])&&(b.style.display="block")},c.hideAllStatus=function(){var b=this.statusElement;b&&(b.style.display="none");this.hideStatusEventElements()},c.hideStatusEventElements=function(){for(var b in this.statusEventElements){var a=this.statusEventElements[b];a&&(a.style.display="none")}},b});
(function(c,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/core infinite-scroll/js/page-load infinite-scroll/js/scroll-watch infinite-scroll/js/history infinite-scroll/js/button infinite-scroll/js/status".split(" "),b):"object"==typeof module&&module.exports&&(module.exports=b(require("./core"),require("./page-load"),require("./scroll-watch"),require("./history"),require("./button"),require("./status")))})(window,function(c){return c});
(function(c,b){"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(f){return b(c,f)}):"object"==typeof module&&module.exports?module.exports=b(c,require("ev-emitter")):c.imagesLoaded=b(c,c.EvEmitter)})("undefined"!=typeof window?window:this,function(c,b){function f(a,b){for(var c in b)a[c]=b[c];return a}function e(a){var b=[];if(Array.isArray(a))b=a;else if("number"==typeof a.length)for(var c=0;c<a.length;c++)b.push(a[c]);else b.push(a);return b}
function a(b,c,d){return this instanceof a?("string"==typeof b&&(b=document.querySelectorAll(b)),this.elements=e(b),this.options=f({},this.options),"function"==typeof c?d=c:f(this.options,c),d&&this.on("always",d),this.getImages(),k&&(this.jqDeferred=new k.Deferred),void setTimeout(function(){this.check()}.bind(this))):new a(b,c,d)}function d(a){this.img=a}function h(a,b){this.url=a;this.element=b;this.img=new Image}var k=c.jQuery,n=c.console;a.prototype=Object.create(b.prototype);a.prototype.options=
{};a.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};a.prototype.addElementImages=function(a){"IMG"==a.nodeName&&this.addImage(a);!0===this.options.background&&this.addElementBackgroundImages(a);var b=a.nodeType;if(b&&l[b]){var c=a.querySelectorAll("img");for(b=0;b<c.length;b++)this.addImage(c[b]);if("string"==typeof this.options.background)for(a=a.querySelectorAll(this.options.background),b=0;b<a.length;b++)this.addElementBackgroundImages(a[b])}};
var l={1:!0,9:!0,11:!0};return a.prototype.addElementBackgroundImages=function(a){var b=getComputedStyle(a);if(b)for(var c=/url\((['"])?(.*?)\1\)/gi,d=c.exec(b.backgroundImage);null!==d;)(d=d&&d[2])&&this.addBackground(d,a),d=c.exec(b.backgroundImage)},a.prototype.addImage=function(a){a=new d(a);this.images.push(a)},a.prototype.addBackground=function(a,b){var c=new h(a,b);this.images.push(c)},a.prototype.check=function(){function a(a,c,d){setTimeout(function(){b.progress(a,c,d)})}var b=this;return this.progressedCount=
0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(b){b.once("progress",a);b.check()}):void this.complete()},a.prototype.progress=function(a,b,c){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;this.emitEvent("progress",[this,a,b]);this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,a);this.progressedCount==this.images.length&&this.complete();this.options.debug&&n&&n.log("progress: "+c,a,b)},a.prototype.complete=function(){var a=this.hasAnyBroken?
"fail":"done";if(this.isComplete=!0,this.emitEvent(a,[this]),this.emitEvent("always",[this]),this.jqDeferred)this.jqDeferred[this.hasAnyBroken?"reject":"resolve"](this)},d.prototype=Object.create(b.prototype),d.prototype.check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",
this),void(this.proxyImage.src=this.img.src))},d.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},d.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.img,b])},d.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},d.prototype.onload=function(){this.confirm(!0,"onload");this.unbindEvents()},d.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindEvents()},d.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",
this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)},h.prototype=Object.create(d.prototype),h.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},h.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",
this)},h.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.element,b])},a.makeJQueryPlugin=function(b){(b=b||c.jQuery)&&(k=b,k.fn.imagesLoaded=function(b,c){return(new a(this,b,c)).jqDeferred.promise(k(this))})},a.makeJQueryPlugin(),a});